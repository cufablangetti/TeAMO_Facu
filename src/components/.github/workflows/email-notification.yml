name: Email Notification on Update

on:
  push:
    branches: [ main, master ]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Get commit info
      id: commit
      run: |
        echo "message=$(git log -1 --pretty=format:'%s')" >> $GITHUB_OUTPUT
        echo "date=$(date)" >> $GITHUB_OUTPUT

    - name: Send email notification
      run: |
        curl -X POST "https://formsubmit.co/ajax/facublangettit@gmail.com" \
        -H "Content-Type: application/json" \
        -d "{
          \"subject\": \"ğŸš€ Â¡PÃ¡gina Te Amo Facu actualizada!\",
          \"message\": \"Â¡Holaa Coti! ğŸ’•\n\nFacu acaba de actualizar la pÃ¡gina especial para ti.\n\nğŸ“ Ãšltimo cambio: ${{ steps.commit.outputs.message }}\nğŸ• Actualizado: ${{ steps.commit.outputs.date }}\n\nâœ¨ Ve los cambios aquÃ­: https://te-amo-facu.vercel.app/\n\nğŸ’¡ Tip: Refresca la pÃ¡gina (F5 o Ctrl+F5) para ver los nuevos cambios.\n\nCon amor desde Argentina ğŸ‡¦ğŸ‡· â¤ï¸\",
          \"_template\": \"basic\"
        }"