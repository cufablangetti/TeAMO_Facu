name: Simple Notification with Gmail

on:
  push:
    branches: [ main ]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Get commit info
      id: commit
      run: |
        echo "message=$(git log -1 --pretty=format:'%s')" >> $GITHUB_OUTPUT
        echo "author=$(git log -1 --pretty=format:'%an')" >> $GITHUB_OUTPUT
        echo "date=$(date '+%d/%m/%Y a las %H:%M')" >> $GITHUB_OUTPUT

    - name: Send Email
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 465
        username: ${{ secrets.GMAIL_USERNAME }}
        password: ${{ secrets.GMAIL_APP_PASSWORD }}
        subject: "🚀 ¡Página Te Amo Facu actualizada!"
        to: sofavoleycap@gmail.com
        from: ${{ secrets.GMAIL_USERNAME }}
        secure: true
        html_body: |
          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
            <h2 style="color: #ff6b6b;">¡Hola Coti! 💕</h2>
            <p style="font-size: 16px;">Facu acaba de actualizar la página especial para ti.</p>
            
            <div style="background-color: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 4px solid #ff6b6b;">
              <p style="margin: 5px 0;"><strong>📝 Último cambio:</strong> ${{ steps.commit.outputs.message }}</p>
              <p style="margin: 5px 0;"><strong>👤 Actualizado por:</strong> ${{ steps.commit.outputs.author }}</p>
              <p style="margin: 5px 0;"><strong>🕐 Fecha:</strong> ${{ steps.commit.outputs.date }}</p>
            </div>
            
            <p style="text-align: center; margin: 30px 0;">
              <a href="https://te-amo-facu.vercel.app/" 
                 style="background-color: #ff6b6b; color: white; padding: 15px 30px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold;">
                ✨ Ver los cambios aquí
              </a>
            </p>
            
            <p style="font-style: italic; color: #6c757d; font-size: 14px;">
              💡 Tip: Refresca la página (Ctrl+F5) para ver los nuevos cambios.
            </p>
            
            <hr style="border: none; border-top: 1px solid #eee; margin: 30px 0;">
            
            <p style="color: #ff6b6b; text-align: center; font-size: 16px;">
              Con amor desde Argentina 🇦🇷 ❤️
            </p>
          </div>
        body: |
          ¡Hola Coti! 💕
          
          Facu acaba de actualizar la página especial para ti.
          
          📝 Último cambio: ${{ steps.commit.outputs.message }}
          👤 Actualizado por: ${{ steps.commit.outputs.author }}
          🕐 Fecha: ${{ steps.commit.outputs.date }}
          
          ✨ Ve los cambios aquí: https://te-amo-facu.vercel.app/
          
          💡 Tip: Refresca la página (Ctrl+F5) para ver los nuevos cambios. Y cuando Quieras publicar una Imagen te va a salir que ingreses una contraseña y es: coti2025
          
          Con amor desde Argentina 🇦🇷 ❤️